自用，部分同步于Fan
